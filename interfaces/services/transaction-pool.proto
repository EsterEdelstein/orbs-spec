syntax = "proto3";

import "primitives/transactions.proto";
import "primitives/gossip-listener.proto";
import "services/configuration-manager.proto";

service TransactionPool {
  rpc AddNewPendingTransaction (AddNewPendingTransactionInput) returns (AddNewPendingTransactionOutput);
  rpc GetAllPendingTransactions (GetAllPendingTransactionsInput) returns (GetAllPendingTransactionsOutput);
  rpc MarkCommittedTransactions (MarkCommittedTransactionsInput) returns (MarkCommittedTransactionsOutput);
  rpc GetTransactionStatus (GetTransactionStatusInput) returns (GetTransactionStatusOutput);
  rpc GossipMessageReceived (GossipListenerInput) returns (GossipListenerOutput);
  rpc UpdateSubscriptionStatus (UpdateSubscriptionStatusInput) returns (UpdateSubscriptionStatusOutput);
}

message AddNewPendingTransactionInput {
  Transaction transaction = 1;
  Ed25519PKey originator = 2;  
}

message AddNewPendingTransactionOutput {
  Bytes txid = 1;
}

message GetAllPendingTransactionsInput {
  Uint64 block_height = 1;
}

message GetAllPendingTransactionsOutput {
  TransactionPoolStatus status = 1;
  repeated TransactionEntry transactionEntries = 2;
}

enum TransactionPoolStatus {
  UPDATED = 0;
  NOT_UPDATED = 1;
}

message GetTransactionStatusInput {
  string txid = 1;
}

enum TransactionStatus {
  NOT_FOUND = 0;
  PENDING = 1;
  COMMITTED = 2;
}

message GetTransactionStatusOutput {
  TransactionStatus status = 1;
  TransactionReceipt receipt = 2;
}

message MarkCommittedTransactionsInput {
  Uint64 block_height = 1;
  repeated TransactionReceipt transactionReceipts  = 2;
}

message MarkCommittedTransactionsOutput {
}