syntax = "proto3";

import "protocol/primitives.proto";
import "protocol/gossip.proto";
import "protocol/blocks.proto";

service BlockStorage {
  rpc CommitOrderingBlock (CommitOrderingBlockInput) returns (CommitOrderingBlockOutput);
  rpc CommitValidationBlock (CommitValidationBlockInput) returns (CommitValidationBlockOutput);
  rpc GetOrderingBlockByHeight (GetBlockByHeightInput) returns (GetOrderingBlockOutput);
  rpc GetValidationBlockByHeight (GetBlockByHeightInput) returns (GetValidationBlockOutput);
  rpc GetOrderingBlockByID (GetBlockByIDInput) returns (GetOrderingBlockOutput);
  rpc GetValidationBlockByID (GetBlockByIDInput) returns (GetValidationBlockOutput);
  rpc GetTopBlock(GetTopBlockInput) returns (GetTopBlockOutput);
  rpc ProcessGossipMessage (ProcessGossipMessageInput) returns (ProcessGossipMessageOutput);
}

message CommitOrderingBlockInput {
  OrderingBlock ordering_block = 1;
}

message CommitOrderingBlockOutput {
 
}

message CommitValidationBlockInput {
  ValidationBlock validation_block = 1;
}

message CommitValidationBlockOutput {

}

message GetBlockByHeightInput {
  Uint64 block_height = 1;
  BlockFormat format = 2;
}

enum BlockFormat {
  STRUCT = 1;
  BINARY = 2;
}

message GetOrderingBlockOutput {
  OrderingBlock ordering_block = 1;
}

message GetValidationBlockOutput {
  ValidationBlock validation_block = 1;
}

message GetBlockByIDInput {
  SHA256 block_id = 1;
}

message GetTopBlockInput { 
  // empty 
}

message GetTopBlockOutput {
  Uint64 block_height = 1;
  SHA256 block_id = 1;
}