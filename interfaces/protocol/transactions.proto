syntax = "proto3";

import "protocol/primitives.proto";
import "protocol/address.proto";

message Transaction {
  TransactionHeader header = 1;
  Bytes payload = 2;
}

message TransactionReceipt {
  Uint256 tx_id = 1; // not really needed, can be part of the bloom filter hard coded fileds 
  Uint32 version = 2;
  TransactionStatus transaction_status = 3;
  String status_message = 4;
  ReceiptBloomFilter bloom_filter = 5;
}

message TransactionHeader {
  Uint32 version = 1;
  Sender sender = 2;
  Uint64 timestamp = 3;
  Address contract_address = 4;
}

enum TransactionStatus {
  RESERVED = 0;
  EXECUTED_SUCCESSFULLY = 1;
  EXECUTED_WITH_SMART_CONTRACT_ERROR = 2;
  EXECUTED_UNEXPECTED_FAILURE = 3; 
  // Status unordered transactions.
  PENDING = 128;
  NO_RECORD_FOUND = 129;
  REJECTED_UNSUPPORTED_VERSION = 130;
  REJECTED_UNSUPPORTED_VERSION = 131;
  REJECTED_VIRTUAL_CHAIN_MISMATCH = 132;
  REJECTED_TIME_STAMP_WINDOW_EXCEEDED = 133;
  REJECTED_SIGNATURE_MISMATCH = 134;
  REJECTED_VIRTUAL_CHAIN_SUBSCRIPTION = 135;
  REJECTED_VIRTUAL_CHAIN_PRE_ORDER = 136;
  REJECTED_SMART_CONTRACT_PRE_ORDER = 137;
  REJECTED_DUPLICATED = 138;
}

message ReceiptBloomFilter {
  Bytes filter = 1;
  // Events bloom filter: (Hard coded indices: 0 - tx_id, 1 - Sender address, 2 - Smart contract address)
}
